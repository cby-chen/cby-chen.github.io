
<!DOCTYPE html>
<html lang="cn" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ubuntu 通过 Netplan 配置网络教程 - chenby</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="chenby,Ubuntu 通过 Netplan 配置网络教程
Ubuntu through Netplan configuration network tutorial

一、Netplan 配置流程
1. N,"> 
    <meta name="author" content="chenby"> 
    <link rel="alternative" href="atom.xml" title="chenby" type="application/atom+xml"> 
    <link rel="icon" href="/img/1.ico"> 
    
    
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Ubuntu 通过 Netplan 配置网络教程 - chenby"/>
    <meta name="twitter:description" content="chenby,Ubuntu 通过 Netplan 配置网络教程
Ubuntu through Netplan configuration network tutorial

一、Netplan 配置流程
1. N,"/>
    
    
    
    
    <meta property="og:site_name" content="chenby"/>
    <meta property="og:type" content="object"/>
    <meta property="og:title" content="Ubuntu 通过 Netplan 配置网络教程 - chenby"/>
    <meta property="og:description" content="chenby,Ubuntu 通过 Netplan 配置网络教程
Ubuntu through Netplan configuration network tutorial

一、Netplan 配置流程
1. N,"/>
    
<link rel="stylesheet" href="/css/diaspora.css">

<meta name="generator" content="Hexo 6.1.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">chenby</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://example.com"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">Ubuntu 通过 Netplan 配置网络教程</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">Ubuntu 通过 Netplan 配置网络教程</h1>
        <div class="stuff">
            <span>十二月 30, 2021</span>
            

        </div>
        <div class="content markdown">
            <p><strong>Ubuntu 通过 Netplan 配置网络教程</strong></p>
<p>Ubuntu through Netplan configuration network tutorial</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f57883d164c4b79a4210075234a7ee8~tplv-k3u1fbpfcp-zoom-1.image" alt="图片"></p>
<p><strong>一、Netplan 配置流程</strong></p>
<p>1. Netplan configuration process</p>
<p><strong>1、Netplan默认配置文件在&#x2F;etc&#x2F;netplan目录下。您可以使用以下命令找到：</strong></p>
<p>1. The default configuration file of Netplan is in the &#x2F;etc&#x2F;netplan directory. You can find it with the following command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /etc/netplan/</span><br></pre></td></tr></table></figure>

<p><strong>就可以看到配置文件名称。</strong></p>
<p>You can see the configuration file name.</p>
<p><strong>2、查看Netplan网络配置文件的内容，执行以下命令：</strong></p>
<p>2. View the contents of the Netplan network configuration file and execute the following command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/netplan/*.yaml</span><br></pre></td></tr></table></figure>

<p><strong>3、现在你需要在任何编辑器中打开配置文件： 由于我使用 vim 编辑器来编辑配置文件，所以我将运行：</strong></p>
<p>3. Now you need to open the configuration file in any editor: Since I use the vim editor to edit the configuration file, I will run:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/netplan/*.yaml</span><br></pre></td></tr></table></figure>

<p><strong>根据您的网络需要更新配置文件。对于静态 IP 寻址，添加 IP 地址、网关、DNS 信息，而对于动态 IP 寻址，无需添加此信息，因为它将从 DHCP 服务器获取此信息。使用以下语法编辑配置文件。</strong></p>
<p>Update the configuration file according to your network needs. For static IP addressing, add IP address, gateway, DNS information, and for dynamic IP addressing, there is no need to add this information because it will get this information from the DHCP server. Use the following syntax to edit the configuration file.</p>
<p><strong>4、在应用任何更改之前，我们将测试配置文件。</strong></p>
<p>4. We will test the configuration file before applying any changes.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo netplan try</span><br></pre></td></tr></table></figure>

<p><strong>如果没有问题，它将返回配置接受消息。如果配置文件未通过测试，它将恢复为以前的工作配置。</strong></p>
<p>If there is no problem, it will return a configuration acceptance message. If the configuration file fails the test, it will revert to the previous working configuration.</p>
<p><strong>5、运行以下命令来应用新配置：</strong></p>
<p>5. Run the following command to apply the new configuration:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo netplan apply</span><br></pre></td></tr></table></figure>

<p><strong>6、成功应用所有配置后，通过运行以下命令重新启动 Network-Manager 服务：</strong></p>
<p>6. After successfully applying all the configurations, restart the Network-Manager service by running the following command:</p>
<p><strong>如果是桌面版：</strong></p>
<p>If it is the desktop version:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart system-networkd</span><br></pre></td></tr></table></figure>

<p><strong>如果您使用的是 Ubuntu 服务器，请改用以下命令：</strong></p>
<p>If you are using an Ubuntu server, use the following command instead:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart network-manager</span><br></pre></td></tr></table></figure>

<p><strong>7、验证 IP 地址</strong></p>
<p>7. Verify the IP address</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip a</span><br></pre></td></tr></table></figure>

<p><strong>二、Netplan 配置文件详解</strong></p>
<p>2. Detailed explanation of Netplan configuration file </p>
<p><strong>1、使用 DHCP：</strong></p>
<p>1. Use DHCP:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line">  ethernets:</span><br><span class="line">    enp3s0:</span><br><span class="line">      dhcp4: true</span><br></pre></td></tr></table></figure>

<p><strong>2、使用静态 IP：</strong></p>
<p>2. Use static IP:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line">  ethernets:</span><br><span class="line">    enp3s0:</span><br><span class="line">      addresses:</span><br><span class="line">        - 10.0.0.10/8</span><br><span class="line">      gateway4: 10.0.0.1</span><br><span class="line">      nameservers:</span><br><span class="line">          search: [mydomain, otherdomain]</span><br><span class="line">          addresses: [10.0.0.5, 1.1.1.1]</span><br></pre></td></tr></table></figure>

<p><strong>3、多个网口 DHCP：</strong></p>
<p>3. Multiple network ports DHCP:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  ethernets:</span><br><span class="line">    enred:</span><br><span class="line">      dhcp4: yes</span><br><span class="line">      dhcp4-overrides:</span><br><span class="line">        route-metric: 100</span><br><span class="line">    engreen:</span><br><span class="line">      dhcp4: yes</span><br><span class="line">      dhcp4-overrides:</span><br><span class="line">        route-metric: 200</span><br></pre></td></tr></table></figure>

<p><strong>4、连接开放的 WiFi（无密码）：</strong></p>
<p>4. Connect to open WiFi (without password):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  wifis:</span><br><span class="line">    wl0:</span><br><span class="line">      access-points:</span><br><span class="line">        opennetwork: &#123;&#125;</span><br><span class="line">      dhcp4: yes</span><br></pre></td></tr></table></figure>

<p><strong>5、连接 WPA 加密的 WiFi：</strong></p>
<p>5. Connect to WPA encrypted WiFi:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line">  wifis:</span><br><span class="line">    wlp2s0b1:</span><br><span class="line">      dhcp4: no</span><br><span class="line">      dhcp6: no</span><br><span class="line">      addresses: [10.0.0.10/8]</span><br><span class="line">      gateway4: 10.0.0.1</span><br><span class="line">      nameservers:</span><br><span class="line">        addresses: [10.0.0.5, 8.8.8.8]</span><br><span class="line">      access-points:</span><br><span class="line">        &quot;network_ssid_name&quot;:</span><br><span class="line">          password: &quot;**********&quot;</span><br></pre></td></tr></table></figure>

<p><strong>6、在单网卡上使用多个 IP 地址（同一网段）：</strong></p>
<p>6. Use multiple IP addresses on a single network card (same network segment):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line">  ethernets:</span><br><span class="line">    enp3s0:</span><br><span class="line">     addresses:</span><br><span class="line">       - 10.0.0.10/8</span><br><span class="line">       - 10.0.0.10/8</span><br><span class="line">     gateway4: 10.0.0.1</span><br></pre></td></tr></table></figure>

<p><strong>7、在单网卡使用多个不同网段的 IP 地址：</strong></p>
<p>7. Use multiple IP addresses of different network segments on a single network card:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line">  ethernets:</span><br><span class="line">    enp3s0:</span><br><span class="line">     addresses:</span><br><span class="line">       - 9.0.0.9/24</span><br><span class="line">       - 10.0.0.10/24</span><br><span class="line">       - 11.0.0.11/24</span><br><span class="line">     #gateway4:    # unset, since we configure routes below</span><br><span class="line">     routes:</span><br><span class="line">       - to: 0.0.0.0/0</span><br><span class="line">         via: 9.0.0.1</span><br><span class="line">         metric: 100</span><br><span class="line">       - to: 0.0.0.0/0</span><br><span class="line">         via: 10.0.0.1</span><br><span class="line">         metric: 100</span><br><span class="line">       - to: 0.0.0.0/0</span><br><span class="line">         via: 11.0.0.1</span><br><span class="line">         metric: 100</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/65712ff42e42446097889a0b6bd631b1~tplv-k3u1fbpfcp-zoom-1.image" alt="Linux运维交流社区"></p>
<p><strong>Linux运维交流社区</strong></p>
<p>Linux运维交流社区，互联网新闻以及技术交流。</p>
<p>35篇原创内容</p>
<p>公众号</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/86040f64eabc4141a87a111afab1d53c~tplv-k3u1fbpfcp-zoom-1.image" alt="图片"></p>
<blockquote>
<p>本文使用 <a target="_blank" rel="noopener" href="https://juejin.cn/post/6940875049587097631">文章同步助手</a> 同步</p>
</blockquote>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="true">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title="0" data-url="https://www.oiox.cn/1.mp3"></li>
                        
                    
                        
                            <li title="1" data-url="https://www.oiox.cn/2.mp3"></li>
                        
                    
                </ul>
            
        </div>
        
    <div id="gitalk-container" class="comment link"
		data-enable="false"
        data-ae="false"
        data-ci=""
        data-cs=""
        data-r=""
        data-o=""
        data-a=""
        data-d="false"
    >查看评论</div>


    </div>
    
        <div class="side">
				
        </div>
    
</div>


    </div>
</div>
</body>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




</html>
